<!DOCTYPE html>
<html>
<head>
	<title>Luft-Emissions-Betriebe</title>

	<meta name="viewport" content="width=device-width, initial-scale=1">
	<style type="text/css">

#mapPagex, #mapCanvasx { width: 100%; height: 100%; padding: 0; }
</style>
	
	<!--jquery-->
	<link rel="stylesheet" href="css/jquery.mobile-1.4.0.min.css" />
	<script src="libs/jquery-1.10.2.min.js"></script>
	<script src="libs/jquery.mobile-1.4.0.min.js"></script>
	
	<!--google maps-->
	<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
	
	<!--plugins-->
	<!--swipebox-->
	<script src="plugins/swipebox/jquery.swipebox.min.js"></script>
	<link rel="stylesheet" href="plugins/swipebox/swipebox.css">


	<!--custom scripts-->
	<script type="text/javascript" src="js/controller_eb.js"></script>
	
	<!-- cordova -->
<!-- 	<script type="text/javascript" charset="utf-8" src="cordova.js"></script> -->
	<script type="text/javascript">
	    var ctr;
	    document.addEventListener("deviceready", onDeviceReady, false);
   		
   		function onDeviceReady() {
	        //exit button
	        $(document).on('tap', '#exitBtn', function() {
				exitFromApp();
			});
	        
		document.addEventListener("backbutton", onBackKeyDown, false);        
	        
	        //controller
	        ctr=new Controller();
	        //check connection
	        if (typeof google != "undefined") {
   				ctr.init();
			}
	        else{alert("keine Verbindung");}
    	}
    	
    	function exitFromApp() {
			navigator.app.exitApp();
		}
		
		function onBackKeyDown(){
                if ( $('.ui-page-active').attr('id') == 'startPage') {
                    exitFromApp();
                } else {
                    history.back();            
                }
		}
	
	
	
	  var clientId = '1065138508028.apps.googleusercontent.com';
      var apiKey = 'AIzaSyAZX14yLHGoDHYUuxfL9LV6wjhCP_afLV0';

      var scopes = 'https://www.googleapis.com/auth/fusiontables';
	  
	// Initialize the client, set onclick listeners.
    function initialize() {
      gapi.client.setApiKey(apiKey);
      window.setTimeout(function() { auth(true); }, 1);
    }
      
      // Run OAuth 2.0 authorization.
      function auth(immediate) {
        gapi.auth.authorize({
          client_id: clientId,
          scope: scopes,
          immediate: immediate
        }, handleAuthResult);
      }
      
      // Handle the results of the OAuth 2.0 flow.
      function handleAuthResult(authResult) {
        var authorizeButton = document.getElementById('authorize-button');
        if (authResult) {
          $("#authorize-button").button( "disable" );
        } else {
          $("#authorize-button").button( "enable" );
        
        	$(document).on('tap', '#authorize-button', function(){ 
				auth(false); return false; 
	    	});
 
        }
      }
	</script>
</head>
<body>


<div data-role="page" id="startPage">
	<div data-role="header" style="overflow:hidden;" data-id="navbar1" data-position="fixed" data-theme="d">
    	<h1>Emissions-Betriebe</h1>
    	<a href="#contactPage" data-role="button" data-icon="info" data-iconpos="notext" data-direction="reverse" class="contactLink ui-btn-right jqm-home">Info</a>
	</div>
	<div data-role="content">
		<h2>Betriebe-Suche:</h2>
		<a href="#betriebeSearchPosPage" data-role="button">In der Nähe</a>
		<a href="#betriebeSearchPLZPage" data-role="button">Nach PLZ</a>
		<a href="#betriebeSearchAdvancedPage" data-role="button">Erweitert</a>
		<h2>Quellen-Suche:</h2>
		<a href="#quellenSearchPage" data-role="button">Quellen</a>
	</div>
	<div data-role="footer">
		<h4>YodaSoft 2014</h4>
	</div>
</div>

<div data-role="page" id="contactPage">
<div data-role="header" style="overflow:hidden;" data-id="navbar1" data-position="fixed" data-theme="d">
    <a href="#" data-rel="back" data-role="button" data-icon="arrow-l" data-iconpos="notext" class="ui-btn-left">back</a>
    <h1>Emissions-Betriebe</h1>
    <a href="#contactPage" data-role="button" data-icon="info" data-iconpos="notext" data-direction="reverse" class="contactLink ui-btn-right jqm-home">Info</a>
</div>
	<div data-role="content">

		<h3>online-Suche nach Betrieben, die Luftverunreinigungen freisetzen</h3>
		<h4>basierend auf der deutsche Implementierung (THRU) des European Pollutant Release and Transfer Register (E-PRTR)</h4>
		<hr/>
		<h3>erstellt von: Udo Lang<h3>
		<h3>Kontakt: ud.lang@gmx.net<h3>
		<hr/>
		<p>
				Die Daten basieren auf dem europäischen Umweltregister:
				European Pollutant Release and Transfer Register (E-PRTR)
				<a href="http://prtr.ec.europa.eu/">http://prtr.ec.europa.eu/</a>
		</p>
		<p>
				Die deutsche Implementierung ist unter THRU als SQL-Lite-DB verfügbar.
				<a href="http://www.thru.de/">http://www.thru.de/</a> 
		</p>
		<p>
				Die Daten sind gefiltert nach Betrieben, die Luftverunreinigungen freisetzen.
				Die Datensätze wurden in eine Google-Fusion-Tabelle geladen.
				<a href="https://www.google.com/fusiontables/DataSource?docid=1zS6OThUNSryAIF8ehyIF6_dy773RO9j4pN4JyXs#rows:id=1">fusion-tabelle</a>
		</p>
		<p>
				Als Abfrage dient client-seitiges SQL über eine google-API
		</p>			
		<p>	
				Der Datenbestand umfasst 1921 Datensätze.
				Aktueller Stand ist 2011
		</p>
	</div>
	
	<div data-role="footer">
		<h4>YodaSoft 2014</h4>
	</div>
	
</div>

<div data-role="page" id="betriebeSearchPosPage">
<div data-role="header" style="overflow:hidden;" data-id="navbar1" data-position="fixed" data-theme="d">
    <a href="#startPage" data-role="button" data-icon="arrow-l" data-iconpos="notext" class="ui-btn-left">back</a>
    <h1>Emissions-Betriebe</h1>
    <a href="#contactPage" data-role="button" data-icon="info" data-iconpos="notext" data-direction="reverse" class="contactLink ui-btn-right jqm-home">Info</a>
    <div data-role="navbar">
        <ul>
            <li><button class="ui-btn ui-corner-all" disabled="disabled">&nbsp;</button></li>
            <li><button class="ui-btn ui-corner-all" disabled="disabled">&nbsp;</button></li>
            <li><button class="showMapBtn_B ui-btn ui-corner-all">Karte</button></li>
        </ul>
    </div>

</div>

<div data-role="content">
			<fieldset>        
				<label for="actPos_BSPP">Position:</label>
				<input id="actPos_BSPP" value="" type="text" disabled="disabled"></input>
				<label for="distPos_BSPP">Entfernung:</label>
				<input id="dist_BSPP" value="10" type="number"/>
 			</fieldset>

	<ul id="betriebeLV_BSPP" data-role="listview" data-autodividers="true" data-split-icon="grid" data-split-theme="d" data-inset="true"></ul>
	</div>
	
	<div data-role="footer">
		<h4>YodaSoft 2014</h4>
	</div>
	
</div>


<div data-role="page" id="betriebeSearchPLZPage">
<div data-role="header" style="overflow:hidden;" data-id="navbar1" data-position="fixed" data-theme="d">
    <a href="#startPage" data-role="button" data-icon="arrow-l" data-iconpos="notext" class="ui-btn-left">back</a>
    <h1>Emissions-Betriebe</h1>
    <a href="#contactPage" data-role="button" data-icon="info" data-iconpos="notext" data-direction="reverse" class="contactLink ui-btn-right jqm-home">Info</a>
    <div data-role="navbar">
        <ul>
            <li><button class="ui-btn ui-corner-all" disabled="disabled">&nbsp;</button></li>
            <li><button class="ui-btn ui-corner-all" disabled="disabled">&nbsp;</button></li>
            <li><button class="showMapBtn_B ui-btn ui-corner-all">Karte</button></li>
        </ul>
    </div>

</div>
	<div data-role="content">
			<fieldset>        
				<label for="distPLZ_BSPLZ">Entfernung:</label>
				<input id="distPLZ_BSPLZ" value="10" type="number"/>
				<label for="pLZ_BSPLZ">PLZ:</label>
				<input id="pLZ_BSPLZ" value="40221" type="number"/>
 			</fieldset>

	<ul id="betriebeLV_BSPLZ" data-role="listview" data-autodividers="true" data-split-icon="grid" data-split-theme="d" data-inset="true"></ul>
	</div>
	
	<div data-role="footer">
		<h4>YodaSoft 2014</h4>
	</div>
	
</div>

<div data-role="page" id="betriebeSearchAdvancedPage">
<div data-role="header" style="overflow:hidden;" data-id="navbar1" data-position="fixed" data-theme="d">
    <a href="#startPage" data-role="button" data-icon="arrow-l" data-iconpos="notext" class="ui-btn-left">back</a>
    <h1>Emissions-Betriebe</h1>
    <a href="#contactPage" data-role="button" data-icon="info" data-iconpos="notext" data-direction="reverse" class="contactLink ui-btn-right jqm-home">Info</a>
    <div data-role="navbar">
        <ul>
            <li><button class="ui-btn ui-corner-all" disabled="disabled">&nbsp;</button></li>
            <li><button class="ui-btn ui-corner-all" disabled="disabled">&nbsp;</button></li>
            <li><button class="showMapBtn_B ui-btn ui-corner-all">Karte</button></li>
        </ul>
    </div>

</div>
	<div data-role="content">
		<fieldset>        
			<label for="name_BSAV">Name:</label>
			<input id="betrName_BSAV" value="" type="text"/>
 			<select id="brancheSel_BSAV" data-native-menu="false"></select>
 		</fieldset>
 		<hr/>	
	
	<div id="moreSearchCol_BSAV" data-role="collapsible" data-mini="true" data-theme="c" data-content-theme="c">
    <h4>mehr:</h4>
	<fieldset>
				<input id="actPosInp_BSAV" value="" type="text" disabled="disabled"></input>
				<label>km:</label>
    			<input id="distPosInp_BSAV" value="" type="number" data-inline="true"/>
		    	<label>
        			<input id="distPosCB_BSAV" type="checkbox">von Position
				</label>
	</fieldset>
	
<hr/>
	
	<fieldset>
				<label>km:</label>
    			<input id="distPLZInp_BSAV" value="" type="number" data-inline="true"/>
    			<label>PLZ:</label>
    			<input id="pLZInp_BSAV" value="" type="number" data-inline="true"/>
		    	<label>
        			<input id="distPLZCB_BSAV" type="checkbox">von PLZ
				</label>
	</fieldset>

</div>

	<button id="BetriebeSearchBtn_BSAV" class="ui-btn ui-corner-all">suchen</button>
	<ul id="betriebeLV_BSAV" data-role="listview" data-autodividers="true" data-split-icon="grid" data-split-theme="d" data-inset="true"></ul>
	</div>
	
	<div data-role="footer">
		<h4>YodaSoft 2014</h4>
	</div>
	
</div>



<div data-role="page" id="quellenSearchPage">
<div data-role="header" style="overflow:hidden;" data-id="navbar1" data-position="fixed" data-theme="d">
    <a href="#startPage" data-role="button" data-icon="arrow-l" data-iconpos="notext" class="ui-btn-left">back</a>
    <h1>Emissions-Quellen</h1>
    <a href="#contactPage" data-role="button" data-icon="info" data-iconpos="notext" data-direction="reverse" class="contactLink ui-btn-right jqm-home">Info</a>
    <div data-role="navbar">
        <ul>
            <li><button class="ui-btn ui-corner-all">&nbsp;</button></li>
            <li><button class="ui-btn ui-corner-all">&nbsp;</button></li>
            <li><button class="showMapBtn_Q ui-btn ui-corner-all">Karte</button></li>
        </ul>
    </div>

</div>

<div data-role="content">
			<fieldset>        
				<label for="nameIP_QSP">Name:</label>
				<input id="nameIP_QSP" value="" type="text"></input>
 			</fieldset>

	<ul id="quelleLV_QSP" data-role="listview" data-autodividers="true" data-split-icon="grid" data-split-theme="d" data-inset="true"></ul>
	</div>
	
	<div data-role="footer">
		<h4>YodaSoft 2014</h4>
	</div>
	
</div>

<div data-role="page" id="quelleDetailPage">
<div data-role="header" style="overflow:hidden;" data-id="navbar1" data-position="fixed" data-theme="d">
    <a href="#quellenSearchPage" data-rel="back" data-role="button" data-icon="arrow-l" data-iconpos="notext" class="ui-btn-left">back</a>

    <h1>Emissions-Quellen</h1>
    <a href="#contactPage" data-role="button" data-icon="info" data-iconpos="notext" data-direction="reverse" class="contactLink ui-btn-right jqm-home">Info</a>

</div>

<div data-role="content">
		<h3>Quelle Details</h3>
			<div id="photoContainer_QDP"></div>
			<fieldset>
				<label for="kennungbetrieb_QDP">Kennung Betrieb:</label>
				<input id="kennungbetrieb_QDP" value="" type="text" disabled="disabled"></input>
				<label for="betrieb_QDP">Betrieb:</label>
				<input id="betrieb_QDP" value="" type="text"></input>
				<label for="anschrift_QDP">Anschrift:</label>
				<input id="anschrift_QDP" value="" type="text"></input>
				<label for="anlage_QDP">Anlage:</label>
				<input id="anlage_QDP" value="" type="text"></input>
				<label for="teilanlage_QDP">Teilanlage:</label>
				<input id="teilanlage" value="" type="text"></input>
				<label for="quelle_QDP">Quelle:</label>
				<input id="quelle_QDP" value="" type="text"></input>
				<label for="quellenbeschreibung_QDP">Quellenbeschreibung:</label>
				<input id="quellenbeschreibung_QDP" value="" type="text"></input>
				<label for="ansprechpartner_QDP">Ansprechpartner:</label>
				<input id="ansprechpartner_QDP" value="" type="text"></input>
				<label for="geometry_QDP">geo:</label>
				<input id="geometry_QDP" value="" type="text" disabled="disabled"></input>
				<label for="hoehe_QDP">Höhe:</label>
				<input id="hoehe_QDP" value="" type="text"></input>
				<label for="lage_QDP">Lage:</label>
				<input id="lage_QDP" value="" type="text"></input>
				<label for="material_QDP">Material:</label>
				<input id="material_QDP" value="" type="text"></input>
				<label for="form_QDP">Form:</label>
				<input id="form_QDP" value="" type="text"></input>
				<label for="durchmesser_QDP">Durchmesser:</label>
				<input id="durchmesser_QDP" value="" type="text"></input>
				<label for="zugang_QDP">Zugang:</label>
				<input id="zugang_QDP" value="" type="text"></input>
				<label for="strom_QDP">Strom:</label>
				<input id="strom_QDP" value="" type="text"></input>
				<label for="messstutzen_QDP">Messstutzen:</label>
				<input id="messstutzen_QDP" value="" type="text"></input>
				<label for="temperatur_QDP">Temperatur:</label>
				<input id="temperatur_QDP" value="" type="text"></input>
				<label for="abgasgeschwindigkeit_QDP">Abgasgeschwindigkeit:</label>
				<input id="abgasgeschwindigkeit_QDP" value="" type="text"></input>
				<label for="dyndruck_QDP">dyn Druck:</label>
				<input id="dyndruck_QDP" value="" type="text"></input>
				<label for="statdruck_QDP">stat Druck:</label>
				<input id="statdruck_QDP" value="" type="text"></input>
				<label for="volumenstrom_QDP">Volumenstrom:</label>
				<input id="volumenstrom_QDP" value="" type="text"></input>
				<label for="komponenten_QDP">Komponenten:</label>
				<input id="komponenten_QDP" value="" type="text"></input>
				<label for="bemerkung_QDP">Bemerkung:</label>
				<input id="bemerkung_QDP" value="" type="text"></input>
 			</fieldset>

</div>
	
	<div data-role="footer">
		<h4>YodaSoft 2014</h4>
	</div>
	
</div>

<div data-role="page" id="mapPage_B">
<div data-role="header" style="overflow:hidden;" data-id="navbar1" data-position="fixed" data-theme="d">
    <!--  <button id="backBtn_MP" data-icon="arrow-l" data-iconpos="notext" class="ui-btn-left ui-corner-all">back</button>-->
    <a href="#" data-rel="back" data-icon="arrow-l" data-iconpos="notext" class="ui-btn-left ui-corner-all">back</a>
    <h1>Emissions-Betriebe</h1>
    <a href="#contactPage" data-role="button" data-icon="info" data-iconpos="notext" data-direction="reverse" class="contactLink ui-btn-right jqm-home">Info</a>
</div>
	<div data-role="content" style="padding:0px;margin:0px;">
    	<div id="mapCanvas_B" style="padding:0px;margin:0px;"></div>
	</div>
	<div data-role="footer">
		<h4>2014</h4>
	</div>
</div>

<div data-role="page" id="mapPage_Q">
<div data-role="panel" id="detailPanel_MPQ" data-position="right" data-display="reveal">
	<button class="ui-btn ui-shadow ui-corner-all ui-btn-icon-left ui-icon-delete" data-rel="close">schließen</button>
	<div id="detailContent_MPQ" style="font-size:8px"></div>
</div>
<div data-role="header" style="overflow:hidden;" data-id="navbar1" data-position="fixed" data-theme="d">
    <!--  <button id="backBtn_MP" data-icon="arrow-l" data-iconpos="notext" class="ui-btn-left ui-corner-all">back</button>-->
    <a href="#" data-rel="back" data-icon="arrow-l" data-iconpos="notext" class="ui-btn-left ui-corner-all">back</a>
    <h1>Emissions-Quellen</h1>
    <a href="#contactPage" data-role="button" data-icon="info" data-iconpos="notext" data-direction="reverse" class="contactLink ui-btn-right jqm-home">Info</a>
</div>
	<div data-role="content" style="padding:0px;margin:0px;">
    	<div id="mapCanvas_Q" style="padding:0px;margin:0px;"></div>
	</div>
	<div data-role="footer">
		<h4>2014</h4>
	</div>
</div>

</body>
<script src="https://apis.google.com/js/client.js?onload=initialize"></script>
</html>